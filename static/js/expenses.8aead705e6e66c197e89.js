"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[6932],{64290:(e,t,n)=>{n.d(t,{Z:()=>s});n(72791);var a=n(57184),r=n(80184);const s=e=>{let{total:t,page:n,onPaginationChange:s,showTotal:l=!0,showSizeChanger:i=!0,showQuickJumper:o=!0,style:c,className:d}=e;const{pageNum:u,pageSize:p}=n.current;return(0,r.jsx)(a.Z,{style:{float:"right",...c},className:d,total:t,showSizeChanger:i,showQuickJumper:o,defaultCurrent:u,defaultPageSize:p,current:u,pageSize:p,onChange:(e,t)=>{n.current={pageSize:t,pageNum:e},s("subimt")},showTotal:e=>{if(l)return"总 ".concat(e," 条")}})}},35443:(e,t,n)=>{n.d(t,{Z:()=>l});n(72791);var a=n(42378),r=n(83298),s=n(80184);const l=e=>{let{children:t,title:n,overlayInnerStyle:l,placement:i="top",color:o}=e;const{token:c}=(0,r.Z)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(a.Z,{placement:i,overlayInnerStyle:l,color:c.colorPrimary,title:n,children:t})})}},90501:(e,t,n)=>{n.d(t,{n:()=>a});const a=(e,t,n)=>{const a=JSON.parse(JSON.stringify(e));return a.splice(n,0,...a.splice(t,1)),a}},96261:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var a=n(72791),r=n(83062),s=n(2641),l=n(35443),i=n(5058),o=n(57689),c=n(11730),d=n(29540),u=n(66106),p=n(30914),h=n(80184);const{SHOW_PARENT:m}=d.default,x=e=>{let{children:t,onSubmit:n,onClose:a}=e;return(0,h.jsxs)(u.Z,{className:"p-2",children:[(0,h.jsx)(p.Z,{children:(0,h.jsx)("div",{className:"w-52",children:t})}),(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(s.ZP,{className:"ml-2",type:"default",onClick:a,children:"清空"}),(0,h.jsx)(s.ZP,{className:"ml-2",type:"primary",onClick:n,children:"确定"})]})]})};var g=n(61126);const y=e=>"treeSelect"===e?g.Z:()=>(0,h.jsx)(h.Fragment,{children:"出错啦"}),f=e=>{let{type:t,form:n,selectedKeys:r,setSelectedKeys:s,confirm:l,visible:i,dataIndex:o,onSearch:c,formItemParams:d}=e;(0,a.useEffect)((()=>{i&&s(n.current[o]||[])}),[i]);return(0,h.jsx)(x,{onClose:()=>{n.current[o]=[],s([]),l(),c()},onSubmit:()=>{n.current[o]=r,s(r),l(),c()},children:y(t)({value:r,...d})})},j=e=>{let{type:t,dataIndex:n,onSearch:a,form:r,formItemParams:s}=e;return{filterDropdown:e=>{let{selectedKeys:l,setSelectedKeys:i,confirm:o,visible:c}=e;return(0,h.jsx)(f,{type:t,form:r,dataIndex:n,selectedKeys:l,setSelectedKeys:i,confirm:o,visible:c,onSearch:a,formItemParams:s})},filterIcon:e=>{var t;return(0,h.jsx)(c.Z,{style:{color:null!==(t=r.current[n])&&void 0!==t&&t.length?"#1890ff":void 0}})}}},k=e=>{let{buttonEvent:t,columnsSeachValue:n}=e;const r=(0,o.s0)(),[c,d]=(0,a.useState)([]);return{columns:[{title:"名字",dataIndex:"name",key:"name",...j({type:"treeSelect",dataIndex:"name",onSearch:()=>t("name"),form:n,formItemParams:{option:[{title:"placeholder",value:"light"},{title:"placeholder1",value:"light1"}],fieldNames:{label:"title",value:"value"},placeholder:"请选择名字"}}),width:100,align:"center",render:(e,t)=>(0,h.jsx)(l.Z,{placement:"top",overlayInnerStyle:{width:200},title:(0,h.jsx)(h.Fragment,{children:e}),children:(0,h.jsx)(s.ZP,{type:"link",style:{width:100},onClick:()=>((e,t)=>{"name"===e&&r("/mycenter",{state:{name:t.name}})})("name",t),children:(0,h.jsx)("div",{className:"truncate",style:{width:70},children:e})})})},{title:"年龄",dataIndex:"age",key:"age",width:100,align:"center",render:e=>(0,h.jsx)(l.Z,{placement:"top",overlayInnerStyle:{width:"100px"},title:(0,h.jsx)(h.Fragment,{children:e}),children:(0,h.jsx)("div",{className:"truncate",children:e})})},{title:"体重",dataIndex:"weight",key:"weight",align:"center",render:e=>(0,h.jsx)(l.Z,{placement:"top",overlayInnerStyle:{width:"100px"},title:(0,h.jsx)(h.Fragment,{children:e}),children:(0,h.jsx)("div",{className:"truncate",children:e})})},{title:"身高",dataIndex:"height",key:"height",align:"center",render:e=>(0,h.jsx)(l.Z,{placement:"top",overlayInnerStyle:{width:"100px"},title:(0,h.jsx)(h.Fragment,{children:e}),children:(0,h.jsx)("div",{className:"truncate",children:e})})},{title:"备注",dataIndex:"remark",key:"remark",align:"center",render:e=>(0,h.jsx)(l.Z,{placement:"top",overlayInnerStyle:{width:"180px"},title:(0,h.jsx)(h.Fragment,{children:e}),children:(0,h.jsx)("div",{className:"truncate",children:e})})},{title:"操作",key:"operation",width:80,align:"center",render:(e,n)=>(0,h.jsx)(i.Z,{option:c,onOpenChange:e=>((e,t)=>{e&&d([{type:"修改",name:"修改",btnType:"link"},{type:"删除",name:"删除",btnType:"link"}])})(e),onClick:e=>t(e,n)})}]}};var v=n(57773),S=n(94805),Z=n(32774),b=n(10930),C=n(40447);const I={position:"fixed",top:138,right:200,zIndex:10,transform:"translate(-50%, 0)"},N=e=>{let{children:t}=e;const n=(0,a.useRef)(),r=(0,a.useRef)(),[l,i]=(0,a.useState)(!0);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(b.E.div,{onDrag:(e,t)=>{n.current=t.offset,r.current=t.point,e.preventDefault(),e.stopPropagation()},onClick:()=>{if(n.current)return setTimeout((()=>{n.current=null}),100);i(!1)},drag:!0,dragElastic:0,dragConstraints:{top:-50,left:-200,right:50,bottom:200},style:{display:l?"block":"none",textAlign:"center",...I},children:(0,h.jsx)(s.ZP,{shape:"circle",icon:(0,h.jsx)(c.Z,{})})}),!l&&(0,h.jsx)("div",{style:{position:"fixed",top:80,left:0,width:"100%",zIndex:10,padding:20},children:(0,h.jsx)(b.E.div,{style:{opacity:0},animate:{opacity:1,y:"auto"},transition:{ease:"linear",duration:.3},children:(0,h.jsxs)(S.Z,{className:"shadow-2xl",children:[t,(0,h.jsx)("div",{children:(0,h.jsx)(s.ZP,{type:"link",onClick:()=>{i(!0)},style:{position:"sticky",bottom:0,left:"50%",transform:"translate(-50%, 0)"},icon:(0,h.jsx)(C.Z,{})})})]})})})]})};var w=n(75202);const F=e=>{let{form:t,formList:n}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(w.r6,{MaxWidth:1540,children:(0,h.jsx)(N,{children:(0,h.jsx)(Z.Z,{form:t,formList:n})})}),(0,h.jsx)(w.go,{MinWidth:1540,children:(0,h.jsx)(S.Z,{bodyStyle:{paddingBottom:0},children:(0,h.jsx)(Z.Z,{form:t,formList:n})})})]})};var P=n(3496);const D=e=>{let{form:t,onFinish:n}=e;const{statusData:r}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const[t,n]=(0,a.useState)([]);(0,a.useEffect)((()=>(r(),()=>{n([])})),e);const r=async()=>{const e=await(0,P.i)(),{data:t}=e;n(t)};return{statusData:t}}(),s=[{type:"input",name:"age",label:"年龄",key:2,layout:{labelCol:{span:6},wrapperCol:{span:18}},span:6},{type:"select",name:"status",label:"状态",comConfig:{option:r,fieldNames:{label:"name",value:"status"}},key:3,layout:{labelCol:{span:6},wrapperCol:{span:18}},span:6},{type:"button",name:"button",key:14,span:6,comConfig:{option:[{btnType:"primary",type:"subimt",name:"搜索",iconFont:"icon-sousuo"},{type:"onReset",name:"重置",iconFont:"icon-zhongzhi",className:"ml-1"}],style:{marginLeft:"10px"},onClick:n}}];return(0,h.jsx)(F,{form:t,formList:s})};var K=n(64290),z=n(92414),T=n(15255),E=n(87175),L=n(89862),O=n(51283),R=n(54341),H=n(90501);const V=e=>{let{initData:t,checkedKeys:n,updateInitData:a,updateCheckedKeys:r}=e;return(0,h.jsx)(R.Z,{className:"draggable-tree",checkedKeys:n,onCheck:e=>{r(e)},draggable:!0,blockNode:!0,onDragEnter:e=>{},onDrop:e=>{const n=t.findIndex((t=>t.headerFieldId===e.dragNodesKeys[0]));if((-1!==e.dropPosition||0!==n)&&e.dropPosition!==n)if(-1===e.dropPosition){let e=(0,H.n)(t,n,0);a(e)}else if(e.dropPosition>n){let r=(0,H.n)(t,n,e.dropPosition-1);a(r)}else if(e.dropPosition<n){let r=(0,H.n)(t,n,e.dropPosition);a(r)}},treeData:t,fieldNames:{title:"headerFieldName",key:"headerFieldId",children:"children"},checkable:!0})},A=(e,t)=>t.reduce(((t,n)=>n.type===e?n.headerField:t),[]);var J=n(51058);const M=e=>{let{type:t,open:n,closeHeader:r}=e;const s=(0,T.TL)(),{headerConfigItem:l,setHeaderConfigItem:i,checkedKeys:o,setCheckedKeys:c}=((e,t)=>{const n=(0,T.CG)(E.RB),[r,s]=(0,a.useState)([]),[l,i]=(0,a.useState)([]);return(0,a.useEffect)((()=>{if(t){const t=A(e,n);s(t);const a=(e=>e.reduce(((e,t)=>"true"===t.headerSelected?[...e,t.headerFieldId]:e),[]))(t);i(a)}}),[n,t]),{headerConfigItem:r,setHeaderConfigItem:s,checkedKeys:l,setCheckedKeys:i}})(t,n),[d,u]=(0,a.useState)(!1),p=async()=>{u(!0);const e=l.reduce(((e,t)=>-1===o.indexOf(t.headerFieldId)?[...e,t.headerFieldId]:e),[]);try{await(n={type:t,headerField:e},(0,J.ZP)({url:"/updateHeader",method:"post",data:n})),s((0,E.Mq)()),r()}catch(e){}var n;u(!1)},m=()=>{r()},[x,g]=(0,a.useState)(!1),[y,f]=(0,a.useState)(!1);(0,a.useEffect)((()=>{0===o.length?j("0"):l.length===o.length?j("2"):j("1")}),[o]);const j=e=>{"0"===e?(g(!1),f(!1)):"1"===e?(g(!0),f(!1)):"2"===e&&(g(!1),f(!0))};return(0,h.jsxs)(O.Z,{title:"编辑表头",open:n,onOkOrCancel:e=>{"ok"===e?p():"cancel"===e&&m()},confirmLoading:d,children:[(0,h.jsx)(L.Z,{indeterminate:x,onChange:e=>{if(g(!1),f(e.target.checked),e.target.checked){const e=l.reduce(((e,t)=>[...e,t.headerFieldId]),[]);c(e)}else c([])},checked:y,children:"全选"}),(0,h.jsx)(V,{initData:l,checkedKeys:o,updateInitData:e=>{i(e)},updateCheckedKeys:e=>{c(e)}})]})},W=(0,a.memo)(M),_=e=>{let{children:t,type:n}=e;const[r,l]=(0,a.useState)(!1),i=(0,a.useCallback)((()=>{l(!1)}),[r]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(u.Z,{justify:"space-between",children:[(0,h.jsx)(p.Z,{children:t}),(0,h.jsx)(p.Z,{children:(0,h.jsx)(u.Z,{children:(0,h.jsx)(p.Z,{children:(0,h.jsx)(s.ZP,{type:"link",icon:(0,h.jsx)(z.Z,{}),onClick:()=>{l(!0)}})})})})]}),(0,h.jsx)(W,{type:n,open:r,closeHeader:i})]})},B=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)(0),[s,l]=(0,a.useState)(!1);return{expensesTableData:e,total:n,getTabelData:async e=>{try{l(!0);const n=await(e=>(0,J.ZP)({url:"/expenses/tabelData",method:"post",data:e}))({...e}),{data:a,total:s}=n;t(a),r(s)}catch(e){}l(!1)},loading:s}};var G=n(46988),Q=n(12606);const q=e=>{const t=(0,o.TH)(),n=e||t.pathname,r=(0,T.TL)(),s=(0,T.CG)(Q.FV),l=(0,a.useMemo)((()=>s),[]),i=["/antd/expenses"];return{initKeepAliveData:l,setKeepAliveData:e=>{i.indexOf(n)>-1&&("/antd/expenses"===n?r((0,Q.x7)(e)):G.ZP.error("没有匹配到缓存path"))}}},U=()=>{const e=(0,a.useRef)({name:[]}),{columns:t}=k({buttonEvent:(e,t)=>{"name"===e&&(u.current.pageNum=1,m("subimt"))},columnsSeachValue:e}),[n]=r.Z.useForm(),{expensesTableData:s,total:l,getTabelData:i,loading:o}=B(),{initKeepAliveData:c,setKeepAliveData:d}=q(),u=(0,a.useRef)({pageSize:(null==c?void 0:c.pageSize)||10,pageNum:(null==c?void 0:c.pageNum)||1}),p=e=>{d(e)};(0,a.useEffect)((()=>{const{pageNum:t,pageSize:a,name:r,age:s,status:l}=c||{};n.setFieldsValue({age:s,status:l}),e.current.name=r,u.current={pageNum:t||u.current.pageNum,pageSize:a||u.current.pageSize},m("subimt")}),[]);const m=t=>{if("subimt"===t){let t=n.getFieldsValue();p({...t,...u.current,...e.current})}else if("onReset"===t){n.resetFields();let t=n.getFieldsValue();p({...t,...u.current,...e.current})}let a=n.getFieldsValue();i({...a,...u.current,...e.current})};return(0,h.jsxs)("div",{children:[(0,h.jsx)(D,{form:n,onFinish:m}),(0,h.jsxs)(S.Z,{bodyStyle:{marginTop:"10px"},children:[(0,h.jsx)(_,{type:"expenses"}),(0,h.jsx)(v.Z,{rowKey:"key",columns:t,data:s,loading:o,scroll:{x:"100%"}}),(0,h.jsx)(K.Z,{className:"mt-4",total:l,page:u,onPaginationChange:m})]})]})}}}]);