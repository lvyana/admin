"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[7224],{29753:function(e,r,n){n.r(r),n.d(r,{default:function(){return l}});var t=n(74165),c=n(15861),a=n(29439),i=n(72791),u=n(87309),o=n(25498),d=n.n(o),s=n(80184),l=function(){var e=(0,i.useState)(!1),r=(0,a.Z)(e,2),n=r[0],o=r[1],l=(0,i.useState)(!1),p=(0,a.Z)(l,2),f=p[0],v=p[1],m=(0,i.useRef)(null),h=(0,i.useRef)(null),y=(0,i.useRef)([]),b=function(){var e=(0,c.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=3;break}return e.next=3,k();case 3:m.current&&m.current.srcObject&&(h.current=new MediaRecorder(m.current.srcObject,{mimeType:"video/webm"})),h.current&&(h.current.ondataavailable=j,h.current.start(),o(!0));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=(0,c.Z)((0,t.Z)().mark((function e(){var r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:r=e.sent,m.current&&(m.current.srcObject=r),v(!0),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),j=function(e){y.current.push(e.data)};return(0,s.jsxs)("div",{children:[(0,s.jsx)("video",{id:"cameraVideo",ref:m,autoPlay:!0}),(0,s.jsxs)("div",{children:[!f&&(0,s.jsx)(u.ZP,{type:"primary",onClick:k,children:"打开摄像头"}),f&&!n&&(0,s.jsx)(u.ZP,{type:"primary",onClick:b,children:"开始录制"}),n&&(0,s.jsx)(u.ZP,{type:"primary",onClick:function(){var e;null===(e=h.current)||void 0===e||e.stop(),o(!1)},children:"停止录制"}),f&&!n&&(0,s.jsx)(u.ZP,{type:"primary",onClick:function(){var e,r=null===(e=m.current)||void 0===e?void 0:e.srcObject;r&&"getTracks"in r&&r.getTracks().forEach((function(e){e.stop()})),m.current&&(m.current.srcObject=null),v(!1)},children:"关闭摄像头"}),h.current&&"inactive"===h.current.state&&(0,s.jsx)(u.ZP,{type:"primary",onClick:function(){var e=new Blob(y.current,{type:"video/webm"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download="video.webm",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),y.current=[]},children:"下载视频"}),f&&(0,s.jsx)(u.ZP,{type:"primary",onClick:function(){var e,r=document.getElementById("cameraVideo");r&&(e=r,d()(e).then((function(e){var r=e.toDataURL("image/png"),n=document.createElement("a");n.style.display="none",n.href=r,n.download="截图.png",document.body.appendChild(n),n.click(),document.body.removeChild(n)})))},children:"拍照"})]})]})}}}]);