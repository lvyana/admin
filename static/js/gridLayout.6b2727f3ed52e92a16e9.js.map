{"version":3,"file":"static/js/gridLayout.6b2727f3ed52e92a16e9.js","mappings":"gLAmDA,IAjCkB,SAACA,GAClB,IAAAC,GAA4BC,EAAAA,EAAAA,YAAwBC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAA7CI,EAAMF,EAAA,GAAEG,EAASH,EAAA,GAElBI,EAAK,IAAIC,EAAAA,EACdC,KAAS,SAACC,EAASC,GAClB,IAE2BC,EAF3BC,GAAAC,EAAAA,EAAAA,GAEoBJ,GAAO,IAA3B,IAAAG,EAAAE,MAAAH,EAAAC,EAAAG,KAAAC,MAA6B,CAAC,IAC7BC,EADeN,EAAAO,MAC4BC,YAAnCC,EAAIH,EAAJG,KAAMC,EAAGJ,EAAHI,IAAKC,EAAKL,EAALK,MAAOC,EAAMN,EAANM,OAC1BlB,EAAU,CAAEe,KAAAA,EAAMC,IAAAA,EAAKC,MAAAA,EAAOC,OAAAA,GAK/B,CAAC,OAAAC,GAAAZ,EAAAa,EAAAD,EAAA,SAAAZ,EAAAc,GAAA,CACF,GAAG,MAeJ,OAZAC,EAAAA,EAAAA,YAAU,WAKT,OAJI5B,GACHO,EAAGsB,QAAQ7B,GAGL,WACFA,GACHO,EAAGuB,UAAU9B,EAEf,CACD,GAAG,CAACA,IAEG,CAAEK,OAAAA,EACV,C,uMCfM0B,EAA2B,CAChC,CAAEC,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAAGC,UAAUC,EAAAA,EAAAA,KAAA,OAAAD,SAAK,SACzC,CAAEJ,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAAIG,KAAM,EAAGC,KAAM,GAC1C,CAAEP,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACvB,CAAEH,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACvB,CAAEH,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACvB,CAAEH,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAAGC,EAAG,GACvB,CAAEH,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAAGC,EAAG,IAyCxB,EAhC0C,SAAHK,GAAiF,IAADC,EAAAD,EAA1EE,OAAAA,OAAM,IAAAD,EAAGV,EAAOU,EAAEE,EAAcH,EAAdG,eAAcC,EAAAJ,EAAEK,KAAAA,OAAI,IAAAD,EANtE,EAM6EA,EAAAE,EAAAN,EAAEjB,MAAAA,OAAK,IAAAuB,EAJ5E,KAI2FA,EACzGV,EAAWW,EAAAA,SAAc,WAC9B,OAAOL,EAAOM,KAAI,SAACC,EAAKC,GACvB,IAAQlB,EAAmBiB,EAAnBjB,EAAGC,EAAgBgB,EAAhBhB,EAAGC,EAAae,EAAbf,EAAGC,EAAUc,EAAVd,EACjB,OAD2Bc,EAAPE,IAOnBd,EAAAA,EAAAA,KAAA,OAAoB,YAAW,CAAEL,EAAAA,EAAGC,EAAAA,EAAGC,EAAAA,EAAGC,EAAAA,GAAKiB,UAAU,cAAahB,SACpEa,EAAIb,WADIiB,EAAAA,EAAAA,KAIZ,GACD,GAAG,CAACX,IAOJ,OACCL,EAAAA,EAAAA,KAAA,OAAAD,UACCC,EAAAA,EAAAA,KAACiB,IAAU,CAACF,UAAU,SAASP,KAAMA,EAAMU,OAAQ,CAAC,EAAG,GAAIC,UAAW,EAAGjC,MAAOA,EAAOoB,eAAgBA,EAAeP,SACpHA,KAKL,ECrEMqB,EAAS,CACd,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,iEACA,kEAsGD,EA3FgB,WACf,IAAQpD,GAAWqD,EAAAA,EAAAA,GAAUC,SAASC,eAAe,mBAA7CvD,OAEFkB,GAAQsC,EAAAA,EAAAA,UAAQ,kBAAMxD,aAAM,EAANA,EAAQkB,KAAK,GAAE,CAAClB,aAAM,EAANA,EAAQkB,SAAW,IAEzDuC,GAASC,EAAAA,EAAAA,QAAuD,IAGhEC,GAAMD,EAAAA,EAAAA,QAAO,GAKbE,EAAS,SAAC9C,GACf,IAAA+C,EAAkD/C,EAAMgD,OAAhDC,EAAYF,EAAZE,aAAcC,EAAUH,EAAVG,WAAYC,EAAWJ,EAAXI,YAG5B9C,EAAS+C,KAAKC,MAAMJ,GAAgB7C,EA1B/B,EA0B8C+C,IAEzDR,EAAOW,QAAQC,KAAK,CAAEN,aAAc5C,EAAQ6C,WAAAA,GAC7C,EAEMM,EAAU,SAAVA,IACLX,EAAIS,SAAW,EAGf,IAAMG,EAAcnB,EAClBoB,QAAO,SAACC,EAAM5B,GACd,OAjBW,GAiBJc,EAAIS,QAAkBvB,GAAKA,GAjBvB,IAiB6Bc,EAAIS,QAAU,EACvD,IACCzB,KAAI,SAAC8B,EAAM5B,GACX,MAAO,CACN6B,IAAKD,EACL9C,GAAIkB,EAtBM,IAsBDc,EAAIS,QAAU,IA1Cf,EA2CRxC,EAAGsC,KAAKC,OAAOtB,EAvBL,IAuBUc,EAAIS,QAAU,IA3C1B,GA4CRvC,EAAG,EACHC,EAAG,IACHC,UAAU4C,EAAAA,EAAAA,eAAc,MAAO,CAC9BC,KAAK5B,EAAAA,EAAAA,KACL9B,MAAO,OACP2D,IAAKJ,EACLb,OAAQA,IAETd,IAAIE,EAAAA,EAAAA,KAEN,IAED8B,GAAgB,SAAChE,GAEhB,MAAM,GAANiE,QAAAC,EAAAA,EAAAA,GACIlE,EAAM6B,KAAI,SAACsC,GAAO,IAADC,EACnB,OAAAC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACIF,GAAC,IACJnD,GAGG,QAFFoD,EAAAzB,EAAOW,QAAQgB,MAAK,SAACX,EAAM5B,GAC1B,OAAO4B,EAAKT,aAAeiB,EAAEP,GAC9B,WAAE,IAAAQ,OAAA,EAFFA,EAEInB,eAAgB,KAEvB,MAAEiB,EAAAA,EAAAA,GACCT,GAEL,IAlDa,IAoDAZ,EAAIS,QAAU,IAAMhB,EAAOiC,QAMxCC,qBACC,WACChB,GACD,GACA,CAAEiB,QAAS,KAEb,GAEAhE,EAAAA,EAAAA,YAAU,WACT+C,GACD,GAAG,IAEH,IAAA1E,GAAwCC,EAAAA,EAAAA,UAA+B,IAAGC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAAnE4F,EAAY1F,EAAA,GAAEgF,EAAehF,EAAA,GAEpC,OACCkC,EAAAA,EAAAA,KAACyD,EAAAA,EAAK,CAAC1C,UAAU,kBAAiBhB,UACjCC,EAAAA,EAAAA,KAAA,OAAKc,GAAG,iBAAiB4C,MAAO,CAAExE,MAAO,KAAOa,UAC/CC,EAAAA,EAAAA,KAAC2D,EAAW,CAACtD,OAAQmD,EAActE,MAAOA,OAI9C,C","sources":["useHooks/useResize.tsx","pluginComponents/iGridLayout/index.tsx","views/plugin/gridLayout/index.tsx"],"sourcesContent":["/**\r\n * @file 监听DOM变化\r\n * @author ly\r\n * @createDate 2022年12月13日\r\n */\r\nimport React, { useEffect, useState } from 'react';\r\nimport ResizeObserver from 'resize-observer-polyfill';\r\nimport debounce from 'lodash/debounce';\r\n\r\ntype ResizeParams = {\r\n\tleft: number;\r\n\ttop: number;\r\n\twidth: number;\r\n\theight: number;\r\n};\r\n\r\n// #----------- 上: ts类型定义 ----------- 分割线 ----------- 下: JS代码 -----------\r\n\r\nconst useResize = (Dom?: HTMLElement | null) => {\r\n\tconst [resize, setResize] = useState<ResizeParams>();\r\n\r\n\tconst ro = new ResizeObserver(\r\n\t\tdebounce((entries, observer) => {\r\n\t\t\t// console.log(entries, observer);\r\n\r\n\t\t\tfor (const entry of entries) {\r\n\t\t\t\tconst { left, top, width, height } = entry.contentRect;\r\n\t\t\t\tsetResize({ left, top, width, height });\r\n\r\n\t\t\t\t// console.log('Element:', entry.target);\r\n\t\t\t\t// console.log(`Element's size: ${width}px x ${height}px`);\r\n\t\t\t\t// console.log(`Element's paddings: ${top}px ; ${left}px`);\r\n\t\t\t}\r\n\t\t}, 500)\r\n\t);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (Dom) {\r\n\t\t\tro.observe(Dom);\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tif (Dom) {\r\n\t\t\t\tro.unobserve(Dom);\r\n\t\t\t}\r\n\t\t};\r\n\t}, [Dom]);\r\n\r\n\treturn { resize };\r\n};\r\n\r\nexport default useResize;\r\n","/**\r\n * @file GridLayout 布局\r\n * @author ly\r\n * @createDate 2020年11月10日\r\n */\r\nimport React, { createElement, FC, useEffect, useMemo, useRef, useState } from 'react';\r\nimport useResize from '@/useHooks/useResize';\r\nimport GridLayout, { Layout } from 'react-grid-layout';\r\nimport 'react-grid-layout/css/styles.css';\r\nimport 'react-resizable/css/styles.css';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\ninterface IgridLayoutProps {\r\n\tlayout?: LayoutsParams[];\r\n\tonLayoutChange?: (layout: Layout[]) => void;\r\n\tcols?: number;\r\n\twidth?: number;\r\n}\r\n\r\n// x 在x轴位置 从0开始\r\n// y 在y轴位置 从0开始\r\n// w 分12等分\r\n// h 高度\r\nexport interface LayoutsParams {\r\n\tx: number;\r\n\ty: number;\r\n\tw: number;\r\n\th: number;\r\n\tminW?: number;\r\n\tmaxW?: number;\r\n\tchildren?: React.ReactNode;\r\n\tid?: string;\r\n}\r\n\r\nconst layouts: LayoutsParams[] = [\r\n\t{ x: 0, y: 0, w: 1, h: 2, children: <div>123</div> },\r\n\t{ x: 1, y: 0, w: 3, h: 10, minW: 2, maxW: 4 },\r\n\t{ x: 4, y: 0, w: 1, h: 2 },\r\n\t{ x: 5, y: 0, w: 1, h: 2 },\r\n\t{ x: 6, y: 0, w: 1, h: 2 },\r\n\t{ x: 7, y: 0, w: 1, h: 2 },\r\n\t{ x: 8, y: 0, w: 4, h: 2 }\r\n];\r\n\r\nconst CLOS = 8;\r\n\r\nconst LAYOUT_WIDTH = 1200;\r\n\r\n// #----------- 上: ts类型定义 ----------- 分割线 ----------- 下: JS代码 -----------\r\n\r\nconst IgridLayout: FC<IgridLayoutProps> = ({ layout = layouts, onLayoutChange, cols = CLOS, width = LAYOUT_WIDTH }) => {\r\n\tconst children = React.useMemo(() => {\r\n\t\treturn layout.map((val, i) => {\r\n\t\t\tconst { x, y, w, h, id } = val;\r\n\t\t\treturn (\r\n\t\t\t\t/**\r\n\t\t\t\t * key:uuidv4()\r\n\t\t\t\t * layout每一次更新都会导致重新渲染\r\n\t\t\t\t * 解决每次更新插入顺序不一致\r\n\t\t\t\t */\r\n\t\t\t\t<div key={uuidv4()} data-grid={{ x, y, w, h }} className=\"bg-blue-100\">\r\n\t\t\t\t\t{val.children}\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t});\r\n\t}, [layout]);\r\n\r\n\t//存储拖拽移动的位置到缓存\r\n\t// const onLayoutChange = (layout: Layout[]) => {\r\n\t// \t// 缓存到后端\r\n\t// \t// console.log(layout, '=----layout----', layouts);\r\n\t// };\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<GridLayout className=\"layout\" cols={cols} margin={[0, 0]} rowHeight={1} width={width} onLayoutChange={onLayoutChange}>\r\n\t\t\t\t{children}\r\n\t\t\t</GridLayout>\r\n\t\t\t{/* <ImgGrid></ImgGrid> */}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default IgridLayout;\r\n","/**\r\n * @file GridLayout 布局\r\n * @author ly\r\n * @createDate 2020年11月10日\r\n */\r\nimport React, { createElement, FC, useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport useResize from '@/useHooks/useResize';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport Icard from '@/antdComponents/iCard';\r\nimport IgridLayout, { LayoutsParams } from '@/pluginComponents/iGridLayout';\r\n\r\nconst urlArr = [\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/6.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/7.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/4.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/5.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/8.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/1.jpg',\r\n\t'https://project-1308388249.cos.ap-guangzhou.myqcloud.com/3.jpg'\r\n];\r\nconst CLOS = 8;\r\n\r\ntype ReaderUrlArrParams = LayoutsParams & { url: string };\r\n// const LAYOUT_WIDTH = 1200;\r\n// const LAYOUT_WIDTH_ITEM = LAYOUT_WIDTH / CLOS;\r\n// #----------- 上: ts类型定义 ----------- 分割线 ----------- 下: JS代码 -----------\r\n\r\n// export default DemoGridLayout;\r\n\r\nconst ImgGrid = () => {\r\n\tconst { resize } = useResize(document.getElementById('DemoGridLayout'));\r\n\r\n\tconst width = useMemo(() => resize?.width, [resize?.width]) || 1000;\r\n\r\n\tconst arrImg = useRef<{ clientHeight: number; currentSrc: string }[]>([]);\r\n\r\n\t// 次数\r\n\tconst num = useRef(0);\r\n\r\n\t// 每次渲染条数\r\n\tconst count = 10;\r\n\r\n\tconst onLoad = (value: { target: HTMLImageElement }) => {\r\n\t\tconst { clientHeight, currentSrc, clientWidth } = value.target;\r\n\r\n\t\t// 计算等比高度\r\n\t\tconst height = Math.floor(clientHeight * (width / CLOS / clientWidth));\r\n\r\n\t\tarrImg.current.push({ clientHeight: height, currentSrc });\r\n\t};\r\n\r\n\tconst getList = () => {\r\n\t\tnum.current += 1;\r\n\r\n\t\t// 每次取count条数数据\r\n\t\tconst splitImgArr = urlArr\r\n\t\t\t.filter((item, i) => {\r\n\t\t\t\treturn num.current * count > i && i >= (num.current - 1) * count;\r\n\t\t\t})\r\n\t\t\t.map((item, i) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\turl: item,\r\n\t\t\t\t\tx: (i + (num.current - 1) * count) % CLOS,\r\n\t\t\t\t\ty: Math.floor((i + (num.current - 1) * count) / CLOS),\r\n\t\t\t\t\tw: 1,\r\n\t\t\t\t\th: 100,\r\n\t\t\t\t\tchildren: createElement('img', {\r\n\t\t\t\t\t\tkey: uuidv4(),\r\n\t\t\t\t\t\twidth: '100%',\r\n\t\t\t\t\t\tsrc: item,\r\n\t\t\t\t\t\tonLoad: onLoad\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tid: uuidv4()\r\n\t\t\t\t};\r\n\t\t\t});\r\n\r\n\t\tsetreaderUrlArr((value) => {\r\n\t\t\t// 寻找对应图片的高度\r\n\t\t\treturn [\r\n\t\t\t\t...value.map((v) => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...v,\r\n\t\t\t\t\t\th:\r\n\t\t\t\t\t\t\tarrImg.current.find((item, i) => {\r\n\t\t\t\t\t\t\t\treturn item.currentSrc === v.url;\r\n\t\t\t\t\t\t\t})?.clientHeight || 100\r\n\t\t\t\t\t};\r\n\t\t\t\t}),\r\n\t\t\t\t...splitImgArr\r\n\t\t\t];\r\n\t\t});\r\n\r\n\t\tif (count * (num.current - 1) >= urlArr.length) return;\r\n\r\n\t\t// requestAnimationFrame(() => {\r\n\t\t// \ta();\r\n\t\t// });\r\n\r\n\t\trequestIdleCallback(\r\n\t\t\t() => {\r\n\t\t\t\tgetList();\r\n\t\t\t},\r\n\t\t\t{ timeout: 20000 }\r\n\t\t);\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tgetList();\r\n\t}, []);\r\n\r\n\tconst [readerUrlArr, setreaderUrlArr] = useState<ReaderUrlArrParams[]>([]);\r\n\r\n\treturn (\r\n\t\t<Icard className=\"overflow-x-auto\">\r\n\t\t\t<div id=\"DemoGridLayout\" style={{ width: 1000 }}>\r\n\t\t\t\t<IgridLayout layout={readerUrlArr} width={width}></IgridLayout>\r\n\t\t\t</div>\r\n\t\t</Icard>\r\n\t);\r\n};\r\nexport default ImgGrid;\r\n"],"names":["Dom","_useState","useState","_useState2","_slicedToArray","resize","setResize","ro","ResizeObserver","debounce","entries","observer","_step","_iterator","_createForOfIteratorHelper","s","n","done","_entry$contentRect","value","contentRect","left","top","width","height","err","e","f","useEffect","observe","unobserve","layouts","x","y","w","h","children","_jsx","minW","maxW","_ref","_ref$layout","layout","onLayoutChange","_ref$cols","cols","_ref$width","React","map","val","i","id","className","uuidv4","GridLayout","margin","rowHeight","urlArr","useResize","document","getElementById","useMemo","arrImg","useRef","num","onLoad","_value$target","target","clientHeight","currentSrc","clientWidth","Math","floor","current","push","getList","splitImgArr","filter","item","url","createElement","key","src","setreaderUrlArr","concat","_toConsumableArray","v","_arrImg$current$find","_objectSpread","find","length","requestIdleCallback","timeout","readerUrlArr","Icard","style","IgridLayout"],"sourceRoot":""}