"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[9659],{55073:(e,r,n)=>{n.r(r),n.d(r,{default:()=>m});var t=n(72791),l=n(2641),a=n(94805),s=n(80184);const c=e=>{let{config:r,readerComponent:n}=e;const{data:l,itemHeight:a,visibleCount:c,key:o,preloadCount:i=6}=r,[u,d]=(0,t.useState)(0),[h,p]=(0,t.useState)(c),m=(0,t.useRef)(null),f=(0,t.useMemo)((()=>l.length*a),[l,a]),g=(0,t.useMemo)((()=>c*a),[c,a]),v=(0,t.useCallback)((()=>{var e,r;const n=null!==(e=null===(r=m.current)||void 0===r?void 0:r.scrollTop)&&void 0!==e?e:0,t=Math.floor(n/a),s=Math.min(t+c,l.length);d(t),p(s)}),[l.length,a,c]);return(0,s.jsx)("div",{ref:m,style:{height:g,overflowY:"auto"},onScroll:v,children:(0,s.jsx)("div",{style:{height:f},children:l.slice(u,h+i).map((e=>(0,s.jsx)("div",{style:{transform:"translateY(".concat(u*a,"px)")},children:n(e)},e[o])))})})};let o;const i=(e,r)=>{let{readerComponent:n,config:l}=e;const{arr:a,eachRenderNum:c,key:i}=l,u=(0,t.useRef)(0),[d,h]=(0,t.useState)([]),p=(0,t.useRef)(!1),m=Math.ceil(a.length/c),f=(0,t.useCallback)((()=>{if(p.current)return;if(u.current>=m)return window.cancelIdleCallback(o);const e=a.slice(u.current*c,(u.current+1)*c);h((r=>[...r,...e])),u.current+=1,o=requestIdleCallback((()=>{f()}),{timeout:1500})}),[]);return(0,t.useImperativeHandle)(r,(()=>({onCallback:()=>{p.current=!1,f()},reset:()=>{p.current=!0,u.current=0,h([])}}))),(0,s.jsx)("div",{style:{height:500,overflow:"auto"},children:d.map((e=>(0,s.jsx)(t.Fragment,{children:n(e)},e[i])))})},u=()=>(0,t.forwardRef)(i);let d=Array.from({length:4e4},((e,r)=>r)).map((e=>({name:"张三"+e,age:e,sex:e%2==0?"男":"女"})));const h=u(),p=e=>{let{name:r,age:n,sex:t}=e;return(0,s.jsxs)("div",{style:{height:50,border:"1px solid blue"},children:[(0,s.jsxs)("span",{children:[" 姓名: ",r]}),(0,s.jsxs)("span",{children:["年龄:",n]}),(0,s.jsxs)("span",{children:[" 性别:",t]})]})},m=()=>{const e=(0,t.useRef)(null);return(0,s.jsxs)(a.Z,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ZP,{type:"primary",onClick:()=>{var r;null===(r=e.current)||void 0===r||r.onCallback()},children:"优化渲染"}),(0,s.jsx)(l.ZP,{type:"primary",onClick:()=>{var r;null===(r=e.current)||void 0===r||r.reset()},children:"清除数据"})]}),(0,s.jsx)(h,{ref:e,config:{arr:d,eachRenderNum:400,key:"age"},readerComponent:p}),(0,s.jsx)(c,{config:{data:d,itemHeight:50,visibleCount:10,key:"age",preloadCount:2},readerComponent:p})]})}}}]);