"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[7224],{29753:(e,r,t)=>{t.r(r),t.d(r,{default:()=>s});var c=t(72791),n=t(2641),a=t(25498),i=t.n(a);const d=e=>{i()(e).then((e=>{let r=e.toDataURL("image/png"),t=document.createElement("a");t.style.display="none",t.href=r,t.download="截图.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)}))};var o=t(80184);const s=()=>{const[e,r]=(0,c.useState)(!1),[t,a]=(0,c.useState)(!1),i=(0,c.useRef)(null),s=(0,c.useRef)(null),l=(0,c.useRef)([]),u=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});i.current&&(i.current.srcObject=e),a(!0)}catch(e){}},p=e=>{l.current.push(e.data)};return(0,o.jsxs)("div",{children:[(0,o.jsx)("video",{id:"cameraVideo",ref:i,autoPlay:!0}),(0,o.jsxs)("div",{children:[!t&&(0,o.jsx)(n.ZP,{type:"primary",onClick:u,children:"打开摄像头"}),t&&!e&&(0,o.jsx)(n.ZP,{type:"primary",onClick:async()=>{t||await u(),i.current&&i.current.srcObject&&(s.current=new MediaRecorder(i.current.srcObject,{mimeType:"video/webm"})),s.current&&(s.current.ondataavailable=p,s.current.start(),r(!0))},children:"开始录制"}),e&&(0,o.jsx)(n.ZP,{type:"primary",onClick:()=>{var e;null===(e=s.current)||void 0===e||e.stop(),r(!1)},children:"停止录制"}),t&&!e&&(0,o.jsx)(n.ZP,{type:"primary",onClick:()=>{var e;const r=null===(e=i.current)||void 0===e?void 0:e.srcObject;if(r&&"getTracks"in r){r.getTracks().forEach((e=>{e.stop()}))}i.current&&(i.current.srcObject=null),a(!1)},children:"关闭摄像头"}),s.current&&"inactive"===s.current.state&&(0,o.jsx)(n.ZP,{type:"primary",onClick:()=>{const e=new Blob(l.current,{type:"video/webm"}),r=URL.createObjectURL(e),t=document.createElement("a");t.href=r,t.download="video.webm",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(r),l.current=[]},children:"下载视频"}),t&&(0,o.jsx)(n.ZP,{type:"primary",onClick:()=>{const e=document.getElementById("cameraVideo");e&&d(e)},children:"拍照"})]})]})}}}]);