{"version":3,"file":"static/js/forwardRef.efae1272e6ddde771ee4.js","mappings":"mKAiDA,UA3BoB,WACnB,IAAMA,GAAcC,EAAAA,EAAAA,QAAwB,MAMtCC,GAAiBD,EAAAA,EAAAA,QAA8B,MAMrD,OACCE,EAAAA,EAAAA,MAACC,EAAAA,EAAK,CAAAC,SAAA,EACLC,EAAAA,EAAAA,KAACC,EAAAA,GAAM,CAACC,KAAK,UAAUC,QAZN,WAAO,IAADC,EACL,QAAnBA,EAAAV,EAAYW,eAAO,IAAAD,GAAnBA,EAAqBE,SACtB,EAU6CP,SAAC,aAG5CC,EAAAA,EAAAA,KAACO,EAAe,CAACC,IAAKd,KACtBM,EAAAA,EAAAA,KAACC,EAAAA,GAAM,CAACC,KAAK,UAAUC,QAVT,WAAO,IAADM,EACC,QAAtBA,EAAAb,EAAeS,eAAO,IAAAI,GAAtBA,EAAwBC,OACzB,EAQ0CX,SAAC,QAGzCC,EAAAA,EAAAA,KAACW,EAAQ,CAACH,IAAKZ,MAGlB,EAKA,IAAMW,GAAkBK,EAAAA,EAAAA,aAA4B,SAACC,EAAOL,GAC3D,IAAMM,GAAKnB,EAAAA,EAAAA,QAA8B,MAYzC,OAVAoB,EAAAA,EAAAA,qBAAoBP,GAAK,WAAO,IAADQ,EAC9B,MAAO,CACNC,KAAgB,QAAZD,EAAEF,EAAGT,eAAO,IAAAW,OAAA,EAAVA,EAAYE,UAClBZ,QAAS,WACJQ,EAAGT,UACNS,EAAGT,QAAQa,UAAY,eAEzB,EAEF,KACOlB,EAAAA,EAAAA,KAAA,OAAKQ,IAAKM,EAAGf,SAAC,WACtB,IACAQ,EAAgBY,YAAc,kBAG9B,IAA2BC,EACpBC,EA4BDV,GA7BqBS,EASgC,SAAHE,GAA4B,IAAtB1B,EAAc0B,EAAd1B,eACvDkB,GAAKnB,EAAAA,EAAAA,QAA8B,MAgBzC,OAdAoB,EAAAA,EAAAA,qBACCnB,GACA,WACC,MAAO,CACNc,MAAO,WAEFI,EAAGT,UACNS,EAAGT,QAAQa,UAAY,UAEzB,EAEF,GACA,KAEMlB,EAAAA,EAAAA,KAAA,OAAKQ,IAAKM,EAAGf,SAAC,OACtB,GA1BOsB,GAAiBT,EAAAA,EAAAA,aAA2B,SAACC,EAAOL,GAEzD,OAAOR,EAAAA,EAAAA,KAACoB,EAAS,CAACxB,eAAgBY,GACnC,KACeW,YAAc,mBACtBE,E","sources":["views/react/hooks/forwardRef/index.tsx"],"sourcesContent":["/**\r\n * @file forWardRef\r\n * @author ly\r\n * @createDate 2020年11月7日\r\n */\r\nimport React, { FC, forwardRef, Ref, useEffect, useImperativeHandle, useRef, useState } from 'react';\r\nimport Icard from '@/antdComponents/iCard';\r\nimport Button from 'antd/es/button';\r\n\r\ntype OnLoginHandler = {\r\n\tlogin: () => void;\r\n};\r\n\r\ntype Ordinary = {\r\n\ttext?: string;\r\n\tcloneEl: () => void;\r\n};\r\n// 1、ref 不会透传\r\n// 2、函数组件是没有实例 需要转发到dom上\r\n\r\n// #----------- 上: ts类型定义 ----------- 分割线 ----------- 下: JS代码 -----------\r\n\r\nconst IforwardRef = () => {\r\n\tconst ordinaryRef = useRef<Ordinary | null>(null);\r\n\r\n\tconst onOrdinary = () => {\r\n\t\tordinaryRef.current?.cloneEl();\r\n\t};\r\n\r\n\tconst onLoginHandler = useRef<OnLoginHandler | null>(null);\r\n\r\n\tconst onLogin = () => {\r\n\t\tonLoginHandler.current?.login();\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Icard>\r\n\t\t\t<Button type=\"primary\" onClick={onOrdinary}>\r\n\t\t\t\t普通转发ref\r\n\t\t\t</Button>\r\n\t\t\t<OrdinaryForWard ref={ordinaryRef}></OrdinaryForWard>\r\n\t\t\t<Button type=\"primary\" onClick={onLogin}>\r\n\t\t\t\t登录\r\n\t\t\t</Button>\r\n\t\t\t<LoginHoc ref={onLoginHandler}></LoginHoc>\r\n\t\t</Icard>\r\n\t);\r\n};\r\n\r\nexport default IforwardRef;\r\n\r\n// 普通转发\r\nconst OrdinaryForWard = forwardRef<Ordinary | null>((props, ref) => {\r\n\tconst el = useRef<HTMLDivElement | null>(null);\r\n\r\n\tuseImperativeHandle(ref, () => {\r\n\t\treturn {\r\n\t\t\ttext: el.current?.innerText,\r\n\t\t\tcloneEl: () => {\r\n\t\t\t\tif (el.current) {\r\n\t\t\t\t\tel.current.innerText = '普通转发ref中....';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t});\r\n\treturn <div ref={el}>普通转发ref</div>;\r\n});\r\nOrdinaryForWard.displayName = 'OrdinaryForWard';\r\n\r\n// HOC转发\r\nconst hocLoginComponent = (Component: FC<{ onLoginHandler: Ref<OnLoginHandler> }>) => {\r\n\tconst LoginComponent = forwardRef<OnLoginHandler>((props, ref) => {\r\n\t\t// 做操作\r\n\t\treturn <Component onLoginHandler={ref}></Component>;\r\n\t});\r\n\tLoginComponent.displayName = 'hocForWardRefCom';\r\n\treturn LoginComponent;\r\n};\r\n\r\nconst Login: FC<{ onLoginHandler: Ref<OnLoginHandler> }> = ({ onLoginHandler }) => {\r\n\tconst el = useRef<HTMLDivElement | null>(null);\r\n\r\n\tuseImperativeHandle(\r\n\t\tonLoginHandler,\r\n\t\t() => {\r\n\t\t\treturn {\r\n\t\t\t\tlogin: () => {\r\n\t\t\t\t\t// console.log(el.current?.innerText);\r\n\t\t\t\t\tif (el.current) {\r\n\t\t\t\t\t\tel.current.innerText = '登录中....';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\treturn <div ref={el}>未登录</div>;\r\n};\r\n\r\nconst LoginHoc = hocLoginComponent(Login);\r\n"],"names":["ordinaryRef","useRef","onLoginHandler","_jsxs","Icard","children","_jsx","Button","type","onClick","_ordinaryRef$current","current","cloneEl","OrdinaryForWard","ref","_onLoginHandler$curre","login","LoginHoc","forwardRef","props","el","useImperativeHandle","_el$current","text","innerText","displayName","Component","LoginComponent","_ref"],"sourceRoot":""}