"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[9659],{55073:(e,r,t)=>{t.r(r),t.d(r,{default:()=>p});var n=t(72791),l=t(2641),a=t(94805),s=t(80184);const c=e=>{let{className:r,config:t,readerComponent:l}=e;const{data:a,itemHeight:c,visibleCount:o,key:i,preloadCount:u=6}=t,[d,h]=(0,n.useState)(0),[m,p]=(0,n.useState)(o),f=(0,n.useRef)(null),g=(0,n.useMemo)((()=>a.length*c),[a,c]),v=(0,n.useMemo)((()=>o*c),[o,c]),x=(0,n.useCallback)((()=>{var e,r;const t=null!==(e=null===(r=f.current)||void 0===r?void 0:r.scrollTop)&&void 0!==e?e:0,n=Math.floor(t/c),l=Math.min(n+o,a.length);h(n),p(l)}),[a.length,c,o]);return(0,s.jsx)("div",{className:r,ref:f,style:{height:v,overflowY:"auto"},onScroll:x,children:(0,s.jsx)("div",{style:{height:g},children:a.slice(d,m+u).map((e=>(0,s.jsx)("div",{style:{transform:"translateY(".concat(d*c,"px)")},children:l(e)},e[i])))})})};let o;const i=(e,r)=>{let{readerComponent:t,config:l}=e;const{arr:a,eachRenderNum:c,key:i}=l,u=(0,n.useRef)(0),[d,h]=(0,n.useState)([]),m=(0,n.useRef)(!1),p=Math.ceil(a.length/c),f=(0,n.useCallback)((()=>{if(m.current)return;if(u.current>=p)return window.cancelIdleCallback(o);const e=a.slice(u.current*c,(u.current+1)*c);h((r=>[...r,...e])),u.current+=1,o=requestIdleCallback((()=>{f()}),{timeout:1500})}),[]);return(0,n.useImperativeHandle)(r,(()=>({onCallback:()=>{m.current=!1,f()},reset:()=>{m.current=!0,u.current=0,h([])}}))),(0,s.jsx)("div",{style:{height:500,overflow:"auto"},children:d.map((e=>(0,s.jsx)(n.Fragment,{children:t(e)},e[i])))})},u=()=>(0,n.forwardRef)(i);let d=Array.from({length:4e4},((e,r)=>r)).map((e=>({name:"张三"+e,age:e,sex:e%2==0?"男":"女"})));const h=u(),m=e=>{let{name:r,age:t,sex:n}=e;return(0,s.jsxs)("div",{style:{height:50,border:"1px solid blue"},children:[(0,s.jsxs)("span",{children:[" 姓名: ",r]}),(0,s.jsxs)("span",{children:["年龄:",t]}),(0,s.jsxs)("span",{children:[" 性别:",n]})]})},p=()=>{const e=(0,n.useRef)(null);return(0,s.jsxs)(a.Z,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ZP,{type:"primary",onClick:()=>{var r;null===(r=e.current)||void 0===r||r.onCallback()},children:"优化渲染"}),(0,s.jsx)(l.ZP,{type:"primary",onClick:()=>{var r;null===(r=e.current)||void 0===r||r.reset()},children:"清除数据"})]}),(0,s.jsx)(h,{ref:e,config:{arr:d,eachRenderNum:400,key:"age"},readerComponent:m}),(0,s.jsx)(c,{className:"mt-8",config:{data:d,itemHeight:50,visibleCount:10,key:"age",preloadCount:2},readerComponent:m})]})}}}]);