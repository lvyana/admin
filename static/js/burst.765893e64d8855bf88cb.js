"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[9659],{55073:function(e,n,r){r.r(n),r.d(n,{default:function(){return v}});var t,u=r(72791),i=r(87309),a=r(94805),c=r(29439),l=r(80184),o=function(e){var n=e.config,r=e.readerComponent,t=n.data,i=n.itemHeight,a=n.visibleCount,o=n.key,s=n.preloadCount,d=void 0===s?6:s,f=(0,u.useState)(0),h=(0,c.Z)(f,2),p=h[0],v=h[1],m=(0,u.useState)(a),g=(0,c.Z)(m,2),x=g[0],C=g[1],k=(0,u.useRef)(null),j=(0,u.useMemo)((function(){return t.length*i}),[t,i]),y=(0,u.useMemo)((function(){return a*i}),[a,i]),b=(0,u.useCallback)((function(){var e,n,r=null!==(e=null===(n=k.current)||void 0===n?void 0:n.scrollTop)&&void 0!==e?e:0,u=Math.floor(r/i),c=Math.min(u+a,t.length);v(u),C(c)}),[t.length,i,a]);return(0,l.jsx)("div",{ref:k,style:{height:y,overflowY:"auto"},onScroll:b,children:(0,l.jsx)("div",{style:{height:j},children:t.slice(p,x+d).map((function(e){return(0,l.jsx)("div",{style:{transform:"translateY(".concat(p*i,"px)")},children:r(e)},e[o])}))})})},s=r(93433),d=function(e,n){var r=e.readerComponent,i=e.config,a=i.arr,o=i.eachRenderNum,d=i.key,f=(0,u.useRef)(0),h=(0,u.useState)([]),p=(0,c.Z)(h,2),v=p[0],m=p[1],g=(0,u.useRef)(!1),x=Math.ceil(a.length/o),C=(0,u.useCallback)((function(){if(!g.current){if(f.current>=x)return window.cancelIdleCallback(t);var e=a.slice(f.current*o,(f.current+1)*o);m((function(n){return[].concat((0,s.Z)(n),(0,s.Z)(e))})),f.current+=1,t=requestIdleCallback((function(){C()}),{timeout:1500})}}),[]);return(0,u.useImperativeHandle)(n,(function(){return{onCallback:function(){g.current=!1,C()},reset:function(){g.current=!0,f.current=0,m([])}}})),(0,l.jsx)("div",{style:{height:500,overflow:"auto"},children:v.map((function(e){return(0,l.jsx)(u.Fragment,{children:r(e)},e[d])}))})},f=Array.from({length:4e4},(function(e,n){return n})).map((function(e){return{name:"张三"+e,age:e,sex:e%2==0?"男":"女"}})),h=(0,u.forwardRef)(d),p=function(e){var n=e.name,r=e.age,t=e.sex;return(0,l.jsxs)("div",{style:{height:50,border:"1px solid blue"},children:[(0,l.jsxs)("span",{children:[" 姓名: ",n]}),(0,l.jsxs)("span",{children:["年龄:",r]}),(0,l.jsxs)("span",{children:[" 性别:",t]})]})},v=function(){var e=(0,u.useRef)(null);return(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(i.ZP,{type:"primary",onClick:function(){var n;null===(n=e.current)||void 0===n||n.onCallback()},children:"优化渲染"}),(0,l.jsx)(i.ZP,{type:"primary",onClick:function(){var n;null===(n=e.current)||void 0===n||n.reset()},children:"清除数据"})]}),(0,l.jsx)(h,{ref:e,config:{arr:f,eachRenderNum:400,key:"age"},readerComponent:p}),(0,l.jsx)(o,{config:{data:f,itemHeight:50,visibleCount:10,key:"age",preloadCount:2},readerComponent:p})]})}}}]);